var Logs={init:function(){Logs.connectWS(),Logs.more()},connectWS:function(){Logs.ws=new ReconnectingWebSocket(logsChannelURL),Logs.ws.onopen=function(){console.log("Connected to logs channel websocket.")},setInterval((function(){Logs.ws.send("p")}),3e4),Logs.ws.onmessage=function(s){var n=JSON.parse(s.data);if("simple"===n.type)Logs.prependLog(n.key1,n.key2,n.key3,n.data)},Logs.ws.onclose=function(){console.log("Disconnected to logs channel websocket.")},Logs.ws.onerror=function(s){console.log("ERROR",s)}},appendLog:function(s,n,o,e){let a=Logs.sumResult(s,n,o,e);$("#logsContent").append(a)},prependLog:function(s,n,o,e){let a=Logs.sumResult(s,n,o,e);$("#logsContent").prepend(a)},sumResult:function(s,n,o,e){let a="";switch(o){case"增加积分":a='<div style="padding: 5px 0;font-size: 15px;">',a+='【 <span style="color: #696969">'+s+"</span> ",a+='<span style="color: #708090">'+n+"</span> 】<br>",a+='「<span style="color: #99CC66">(add)'+o+"</span>」 ",a+='<span style="color: #1E90FF">'+e+"</span> ",a+="</div>";break;case"扣除积分":a='<div style="padding: 5px 0;font-size: 15px;">',a+='【 <span style="color: #696969">'+s+"</span> ",a+='<span style="color: #708090">'+n+"</span> 】<br>",a+='「<span style="color: #FF6666">(reduce)'+o+"</span>」 ",a+='<span style="color: #1E90FF">'+e+"</span> ",a+="</div>";break;case"发送弹幕":a='<div style="padding: 5px 0;font-size: 15px;">',a+='【 <span style="color: #696969">'+s+"</span> ",a+='<span style="color: #708090">'+n+"</span> 】<br>",a+='「<span style="color: #FF9900">(post)'+o+"</span>」 ",a+='<span style="color: #1E90FF">'+e+"</span> ",a+="</div>";break;default:a='<div style="padding: 5px 0;font-size: 15px;">',a+='【 <span style="color: #696969">'+s+"</span> ",a+='<span style="color: #708090">'+n+"</span> 】<br>",a+='「<span style="color: #6A5ACD">(handle)'+o+"</span>」 ",a+='<span style="color: #1E90FF">'+e+"</span> ",a+="</div>"}return a},page:1,more:function(){$.ajax({url:Label.servePath+"/logs/more?page="+Logs.page+"&pageSize=30",type:"GET",async:!1,success:function(s){if(0===s.code){let n=s.data;0===n.length?$("#loadMoreBtn").html("没有更多内容了"):n.forEach((s=>{Logs.appendLog(s.key1,s.key2,s.key3,s.data)}))}}}),Logs.page++}};$(document).ready((function(){Logs.init()}));