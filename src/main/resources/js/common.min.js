var Util={bling:void 0,isBlinging:!1,ipAction:function(e){switch(e){case 1:$("#ipType").val("ban");break;case 2:$("#ipType").val("unban")}$("#ipListForm").submit()},insertWarnBroadcastModel:function(e){let t="";switch(e){case 1:t="摸鱼派社区即将进行升级维护，预计停服时间：<b>5分钟</b><br>维护完成后摸鱼派将自动刷新（客户端请手动重新登录），感谢你的理解～<br>摸鱼这么久了，去给自己倒杯咖啡吧 ☕️";break;case 2:t="摸鱼派社区即将进行升级维护，预计停服时间：<b>20秒</b><br>维护完成后摸鱼派将自动刷新（客户端请手动重新登录），感谢你的理解～<br>摸鱼这么久了，去给自己倒杯咖啡吧 ☕️"}$("[name='warnBroadcastText']").val(t)},genMetal:(e,t)=>"https://fishpi.cn/gen?ver=0.1&scale=0.79&txt="+e+(t=void 0!==t&&""!==t?"&"+t:""),genMiniMetal:e=>"https://fishpi.cn/gen?ver=0.1&scale=0.79&txt="+(e=void 0!==e&&""!==e?"&"+e:""),parseDom(e){var t=document.createElement("div");return t.innerHTML=e,t.childNodes},parseArray(arrStr){var tempKey="arr23"+(new Date).getTime(),arrayJsonStr='{"'+tempKey+'":'+arrStr+"}",arrayJson;return arrayJson=JSON&&JSON.parse?JSON.parse(arrayJsonStr):eval("("+arrayJsonStr+")"),arrayJson[tempKey]},fadeIn(e,t){let a=0;for(let n=0;n<100;n++)setTimeout((function(){a=+(a+.01).toFixed(2),e.style.opacity=a,99===n&&setTimeout(t,200)}),5*n)},fadeOut(e,t){let a=1;for(let n=0;n<100;n++)setTimeout((function(){a=+(a-.01).toFixed(2),e.style.opacity=a,99===n&&setTimeout(t,400)}),5*n)},getAtUsers:function(e){var t=[];return $.ajax({url:Label.servePath+"/users/names",type:"POST",async:!1,data:JSON.stringify({name:e}),success:function(e){if(0===e.code)for(var a=0;a<e.data.length;a++)t.push({value:"@"+e.data[a].userName+" ",html:'<img src="'+e.data[a].userAvatarURL48+'"/>'+e.data[a].userName,avatar:e.data[a].userAvatarURL48,username:e.data[a].userName});else alert(e.msg)}}),t},LazyLoadImage:function(){var e=function(e){var t=document.createElement("img");t.src=e.getAttribute("data-src"),t.addEventListener("load",(function(){$(e).attr("style")||$(e).attr("class")||$(e).attr("width")||$(e).attr("height")||1!==$(e).closest(".vditor-reset").length||t.naturalHeight>t.naturalWidth&&t.naturalWidth/t.naturalHeight<$(e).closest(".vditor-reset").width()/($(window).height()-40)&&t.naturalHeight>$(window).height()-40&&(e.style.height=$(window).height()-40+"px"),$(e).attr("class")||1!==$(e).closest(".vditor-reset").length||_processPreview($(e)),e.src=t.src,e.style.backgroundImage="none",e.style.backgroundColor="transparent"})),e.removeAttribute("data-src")};if(!("IntersectionObserver"in window))return $("img").each((function(){this.getAttribute("data-src")&&e(this)})),!1;window.imageIntersectionObserver?(window.imageIntersectionObserver.disconnect(),$("img").each((function(){window.imageIntersectionObserver.observe(this)}))):(window.imageIntersectionObserver=new IntersectionObserver((function(t){t.forEach((function(t){(void 0===t.isIntersecting?0!==t.intersectionRatio:t.isIntersecting)&&t.target.getAttribute("data-src")&&e(t.target)}))})),$("img").each((function(){window.imageIntersectionObserver.observe(this)})))},addStyle:function(e,t){if(!document.getElementById(t)){var a=document.createElement("link");a.id=t,a.setAttribute("rel","stylesheet"),a.setAttribute("type","text/css"),a.setAttribute("href",e),document.getElementsByTagName("head")[0].appendChild(a)}},parseHljs:function(){Vditor.highlightRender({style:"github",enable:!Label.luteAvailable},document)},parseMarkdown:function(){Vditor.mermaidRender(document.body),Vditor.flowchartRender(document.body),Vditor.chartRender(),Vditor.mindmapRender(),Vditor.mathRender(document.body),Vditor.codeRender(document.body,Label.langLabel),Vditor.abcRender(),Vditor.graphvizRender(document.body),Vditor.plantumlRender(document.body);var e=!1;if($(".vditor-reset").each((function(){$(this).find("a").each((function(){var t=$(this).attr("href");t&&".mov"===t.substr(t.length-4).toLowerCase()&&(e=!0)}))})),e){var t=function(){$(".vditor-reset").each((function(){$(this).find("a").each((function(){var e=$(this),t=$(this).attr("href");if(t&&".mov"===t.substr(t.length-4).toLowerCase()){this.style.height="360px",this.style.width="270px",e.removeAttr("href");var a=LivePhotosKit.Player(this);a.photoSrc=Label.staticServePath+"/images/livephoto.png",a.videoSrc=t}}))}))};"undefined"!=typeof LivePhotosKit?t():$.ajax({method:"GET",url:Label.staticServePath+"/js/lib/livephotoskit.js",dataType:"script",cache:!0}).done((function(){t()}))}},prevKey:void 0,clipboard:function(e,t,a){e.click((function(e){t[0].select();try{document.execCommand("copy")?a():console.log("Copy command was unsuccessful")}catch(e){console.log("Oops, unable to copy")}window.getSelection().removeAllRanges()}))},closeAlert:function(){$(document).mouseup((function(){$("body").css("overflow",""),$(document).off("mousemove")})).on("touchend",(function(e){$("body").css("overflow",""),$(document).off("touchmove")})),$("#alertDialogPanel,.dialog-background").fadeOut(200),setTimeout((function(){$("#alertDialogPanel,.dialog-background").remove()}),200)},clearAlert(){$("#alertDialogPanel,.dialog-background").remove()},alert:function(e,t=""){var a;a='<div onclick="Util.closeAlert(this)" style="height: '+document.documentElement.scrollHeight+'px;display: block;" class="dialog-background"></div>'+('<div class="dialog-panel" id="alertDialogPanel" tabindex="0"><div class="fn-clear dialog-header-bg"><span style="font-size: 14px;">'+t+'</span><a class="icon-close" href="javascript:void(0);" onclick="Util.closeAlert()"><svg><use xlink:href="#close"></use></svg></a></div><div class="dialog-main" style="text-align:center;padding: 30px 10px 40px">'+e+"</div></div>"),$("body").append(a),$("#alertDialogPanel").css({top:($(window).height()-$("#alertDialogPanel").height())/2+"px",left:($(window).width()-$("#alertDialogPanel").width())/2+"px",outline:"none"}).fadeIn(200).focus(),function(e){function t(t){const a=$(e).offset(),n=(t=t.pageX?t:t.targetTouches[0]).pageX-a.left,i=t.pageY-a.top;function o(t){$("body").css("overflow","hidden");let a=(t=t.pageX?t:t.targetTouches[0]).pageX-n,o=t.pageY-i-$(window).scrollTop();a<0?a=0:a>$(document).width()-$(e).outerWidth(!0)&&(a=$(document).width()-$(e).outerWidth(!0)),o<0?o=0:o>$(document).height()-$(e).outerHeight(!0)&&(o=$(document).height()-$(e).outerHeight(!0)),$(e).css({left:a+"px",top:o+"px"})}$(document).mousemove(o).on("touchmove",o),$(document).mouseup((function(){$("body").css("overflow",""),$(document).off("mousemove")})).on("touchend",(function(e){$("body").css("overflow",""),$(document).off("touchmove")}))}$(".dialog-header-bg").mousedown(t).on("touchstart",t)}("#alertDialogPanel")},makeNotificationRead:function(e,t){return $.ajax({url:Label.servePath+"/notifications/make-read/"+e,type:"GET",cache:!1,success:function(e,a){0===e.code&&(Util.setUnreadNotificationCount(!1),$(".notification li").addClass("read"),t&&($(t).prev().remove(),$(t).remove(),0===$(".home-menu .count").length&&$(".module-header:last > span").remove()))}}),!1},_initCommonHotKey:function(){if(!Label.userKeyboardShortcutsStatus||"1"===Label.userKeyboardShortcutsStatus)return!1;var e=function(e){var t=$(".list > ul > li.focus"),a=0===$(".radio-btn").length?0:48;if(1===t.length){if("top"===e||"bottom"===e)return $(window).scrollTop(t.offset().top-a),!1;($(window).height()+$(window).scrollTop()<t.offset().top+t.outerHeight()||$(window).scrollTop()>t.offset().top)&&("down"===e?$(window).scrollTop(t.offset().top-($(window).height()-t.outerHeight())):$(window).scrollTop(t.offset().top-a))}};0===$("#articleTitle").length&&$(document).bind("keydown","c",(function(e){return Util.prevKey||(window.location=Label.servePath+"/post?type=0"),!1})),$(document).bind("keyup","g",(function(){return Util.prevKey="g",setTimeout((function(){Util.prevKey=void 0}),1e3),!1})).bind("keyup","s",(function(){return $("#search").focus(),!1})).bind("keyup","t",(function(){return void 0===Util.prevKey&&Util.goTop(),!1})).bind("keyup","n",(function(e){return"g"===Util.prevKey&&(window.location=Label.servePath+"/notifications"),!1})).bind("keyup","h",(function(e){return"g"===Util.prevKey&&(window.location=Label.servePath+"/hot"),!1})).bind("keyup","i",(function(e){return"g"===Util.prevKey&&(window.location=Label.servePath),!1})).bind("keyup","r",(function(e){return"g"===Util.prevKey&&(window.location=Label.servePath+"/recent"),!1})).bind("keyup","p",(function(e){return"g"===Util.prevKey&&(window.location=Label.servePath+"/perfect"),!1})).bind("keyup","Shift+/",(function(e){return window.open(Label.servePath+"/article/1631459254239"),!1})).bind("keyup","j",(function(t){var a=".content .list:last > ul > ";1===$("#comments").length&&(a="#comments .list > ul > ");var n=$(a+"li.focus");return 0===n.length?$(a+"li:first").addClass("focus"):1===n.next().length&&(n.next().addClass("focus"),n.removeClass("focus")),e("down"),!1})).bind("keyup","k",(function(t){var a=".content .list:last > ul > ";1===$("#comments").length&&(a="#comments .list > ul > ");var n=$(a+"li.focus");return 0===n.length?$(a+"li:last").addClass("focus"):1===n.prev().length&&(n.prev().addClass("focus"),n.removeClass("focus")),e("up"),!1})).bind("keyup","f",(function(t){var a=".content .list:last > ul > ";return 1===$("#comments").length&&(a="#comments .list > ul > "),$(a+"li.focus").removeClass("focus"),$(a+"li:first").addClass("focus"),e("top"),!1})).bind("keyup","l",(function(t){if(Util.prevKey)return!1;var a=".content .list:last > ul > ";return 1===$("#comments").length&&(a="#comments .list > ul > "),$(a+"li.focus").removeClass("focus"),$(a+"li:last").addClass("focus"),e("bottom"),!1})).bind("keyup","o",(function(e){if(1===$("#comments").length)return!1;var t=$(".content .list:last > ul > li.focus > h2 > a").attr("href");return t||(t=$(".content .list:last > ul > li.focus .fn-flex-1 > h2 > a").attr("href")),t||(t=$(".content .list:last > ul > li.focus h2.fn-flex-1 > a").attr("href")),t&&(window.location=t),!1})).bind("keyup","return",(function(e){if(1===$("#comments").length)return!1;var t=$(".content .list:last > ul > li.focus > h2 > a").attr("href");return t||(t=$(".content .list:last > ul > li.focus .fn-flex-1 > h2 > a").attr("href")),t||(t=$(".content .list:last > ul > li.focus h2.fn-flex-1 > a").attr("href")),t&&(window.location=t),!1}))},notifyMsg:function(e){if(!("Notification"in window))return!1;var t=function(e){var t=new Notification(Label.visionLabel,{body:Label.desktopNotificationTemplateLabel.replace("${count}",e),icon:Label.staticServePath+"/images/faviconH.png"});t.onclick=t.onerror=function(){window.location=Label.servePath+"/notifications"}};"granted"===Notification.permission?t(e):"denied"!==Notification.permission&&Notification.requestPermission((function(a){"granted"===a&&t(e)}))},processClipBoard:function(e,t){if(""===e.getData("text/html")&&2===e.items.length)return"";var a=!1,n=toMarkdown(e.getData("text/html"),{converters:[{filter:"img",replacement:function(e,a){if(1===a.attributes.length)return"";var n={url:a.src};return $.ajax({url:Label.servePath+"/fetch-upload",type:"POST",data:JSON.stringify(n),cache:!1,success:function(e,a){if(0===e.code){var n=t.getValue();n=n.replace(e.originalURL,e.url),t.setValue(n)}}}),"![]("+a.src+")"}},{filter:["pre","code"],replacement:function(e){return e.split("\n").length>1&&(a=!0),"`"+e+"`"}}],gfm:!0});if(a)return event.originalEvent.clipboardData.getData("text/plain");var i=document.createElement("div");return i.innerHTML=n,n=i.innerText.replace(/\n{2,}/g,"\n\n").replace(/(^\s*)|(\s*)$/g,"")},getParameterByName:function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))},getDeviceByUa:function(e){$.ua.set(e);var t=$.ua.device.model?$.ua.device.model:$.ua.os.name;return t&&"Windows"!==t||(t=""),t},initSearch:function(e,t,a){var n=algoliasearch(e,t).initIndex(a);$("#search").autocomplete({hint:!1,templates:{footer:'<div class="fn-right fn-pointer" onclick="window.open(\'https://www.algolia.com\')"><span class="ft-gray">With &hearts; from</span> <img src="'+Label.staticServePath+'/images/services/algolia128x40.png" /> </div>'}},[{source:function(e,t){n.search(e,{hitsPerPage:20},(function(e,a){e?t([]):t(a.hits,a)}))},displayKey:"name",templates:{suggestion:function(e){return e._highlightResult.articleTitle.value}}}]).on("autocomplete:selected",(function(e,t,a){window.open(Label.servePath+"/article/"+t.oId)})).bind("keyup","esc",(function(){$(this).blur()}))},newVditor:function(e){Label.emoji||$.ajax({url:Label.servePath+"/users/emotions",type:"GET",cache:!0,async:!1,success:function(e){Label.emoji={},e.data.forEach((function(e){var t=Object.keys(e)[0];Label.emoji[t]=e[t]}))}});var t={outline:e.outline||{enable:!1},after:e.after||void 0,typewriterMode:e.typewriterMode||!1,cache:{enable:e.cache||!1},input:e.input,preview:{delay:500,mode:e.preview.mode,url:Label.servePath+"/markdown",parse:function(e){"none"!==e.style.display&&Util.LazyLoadImage()},hljs:{enable:!Label.luteAvailable}},upload:{max:Label.fileMaxSize,url:Label.servePath+"/upload",filename:function(e){return e.replace(/\?|\\|\/|:|\||<|>|\*|\[|\]|\s+/g,"-")},accept:".zip,.rar,.7z,.tar,.gzip,.bz2,.jar,.jpg,.jpeg,.png,.gif,.webp,.webm,.bmp,.mp3,.mp4,.wav,.mov,.weba,.mkv"},placeholder:e.placeholder,height:e.height,counter:{enable:!!e.counter,max:e.counter},resize:{enable:e.resize.enable,position:e.resize.position},lang:Label.langLabel,hint:{parse:!1,emojiTail:'<a href="'+Label.servePath+'/settings/function" target="_blank">设置常用表情</a>',emoji:Label.emoji,extend:[{key:"@",hint:function(e){var t=[];return $.ajax({url:Label.servePath+"/users/names",type:"POST",async:!1,data:JSON.stringify({name:e}),success:function(a){if(0===a.code){for(var n=0;n<a.data.length;n++)t.push({value:"@"+a.data[n].userName+" ",html:'<img src="'+a.data[n].userAvatarURL48+'"/>'+a.data[n].userName});""===e&&t.push({html:'<img src="'+Label.staticServePath+'/images/user-thumbnail.png"/> 参与者',value:"@participants "})}else alert(a.msg)}}),t}}]},esc:e.esc,ctrlEnter:e.ctrlEnter};return $(window).width()<768?(t.toolbar=["emoji","link","upload","edit-mode",{name:"more",toolbar:["insert-after","fullscreen","preview","info","help"]}],t.resize.enable=!1):e.toolbar&&(t.toolbar=e.toolbar),new Vditor(e.id,t)},setUnreadNotificationCount:function(e){$.ajax({url:Label.servePath+"/notifications/unread/count",type:"GET",cache:!1,success:function(t,a){var n=function(e){var t="",a='<span onclick="Util.makeNotificationRead(\'${markReadType}\');return false;" aria-label="'+Label.makeAsReadLabel+'" class="fn-right tooltipped tooltipped-nw"><svg><use xlink:href="#check"></use></svg></span>';return e.unreadCommentedNotificationCnt>0&&(t+='<li><a href="'+Label.servePath+'/notifications/commented">'+Label.notificationCommentedLabel+' <span class="count">'+e.unreadCommentedNotificationCnt+"</span>"+a.replace("${markReadType}","commented")+"</a></li>"),e.unreadReplyNotificationCnt>0&&(t+='<li><a href="'+Label.servePath+'/notifications/reply">'+Label.notificationReplyLabel+' <span class="count">'+e.unreadReplyNotificationCnt+"</span>"+a.replace("${markReadType}","reply")+"</a></li>"),e.unreadAtNotificationCnt>0&&(t+='<li><a href="'+Label.servePath+'/notifications/at">'+Label.notificationAtLabel+' <span class="count">'+e.unreadAtNotificationCnt+"</span>"+a.replace("${markReadType}","at")+"</a></li>"),e.unreadFollowingNotificationCnt>0&&(t+='<li><a href="'+Label.servePath+'/notifications/following">'+Label.notificationFollowingLabel+' <span class="count">'+e.unreadFollowingNotificationCnt+"</span>"+a.replace("${markReadType}","following")+"</a></li>"),e.unreadPointNotificationCnt>0&&(t+='<li><a href="'+Label.servePath+'/notifications/point">'+Label.pointLabel+' <span class="count">'+e.unreadPointNotificationCnt+"</span></a></li>"),e.unreadBroadcastNotificationCnt>0&&(t+='<li><a href="'+Label.servePath+'/notifications/broadcast">'+Label.sameCityLabel+' <span class="count">'+e.unreadBroadcastNotificationCnt+"</span></a></li>"),e.unreadSysAnnounceNotificationCnt>0&&(t+='<li><a href="'+Label.servePath+'/notifications/sys-announce">'+Label.systemLabel+' <span class="count">'+e.unreadSysAnnounceNotificationCnt+"</span></a></li>"),e.unreadNewFollowerNotificationCnt>0&&(t+='<li><a href="'+Label.servePath+"/member/"+Label.currentUserName+'/followers">'+Label.newFollowerLabel+' <span class="count">'+e.unreadNewFollowerNotificationCnt+"</span></a></li>"),t},i=t.unreadNotificationCnt;if($.ua.set(navigator.userAgent),$.ua.device.type&&"mobile"===$.ua.device.type){if(0<i){$("#aNotifications").removeClass("no-msg").addClass("msg").text(i).attr("href","javascript:void(0)"),0===t.userNotifyStatus&&window.localStorage.hadNotificate!==i.toString()&&e&&(Util.notifyMsg(i),window.localStorage.hadNotificate=i);var o=n(t);if(1===$("#notificationsPanel").length)return $("#notificationsPanel ul").html(o),!1;$(".main:first").prepend('<div id="notificationsPanel" class="tab-current fn-clear fn-none"><ul class="tab fn-clear">'+o+"</ul></div>"),$("#aNotifications").click((function(){$("#notificationsPanel").slideToggle()}))}else window.localStorage.hadNotificate="false",$("#aNotifications").removeClass("msg").addClass("no-msg").text(i).attr("href",Label.servePath+"/notifications");return!1}let r='<svg style="height: 15px;pointer-events: none;">  <use xlink:href="#notification"></use></svg>&nbsp;';if(0<i){$("#aNotifications").removeClass("no-msg tooltipped tooltipped-w").addClass("msg").html(r+i).attr("href","javascript:void(0)"),0===t.userNotifyStatus&&window.localStorage.hadNotificate!==i.toString()&&e&&(Util.notifyMsg(i),window.localStorage.hadNotificate=i);o=n(t);if(1===$("#notificationsPanel").length)return $("#notificationsPanel ul").html(o),!1;$("#aNotifications").after('<div id="notificationsPanel" class="module person-list"><ul>'+o+"</ul></div>"),$("#aNotifications").click((function(e){let t=window.innerWidth-e.pageX-$("#notificationsPanel").width()/2;console.log(t),$("#notificationsPanel").css("right",t+"px"),$("#notificationsPanel").show()})),$("body").click((function(e){"aNotifications"!==e.target.id&&"notificationsPanel"!==$(e.target).closest(".module").attr("id")&&$("#notificationsPanel").hide()}))}else window.localStorage.hadNotificate="false",$("#notificationsPanel").remove(),$("#aNotifications").removeClass("msg").addClass("no-msg tooltipped tooltipped-w").html(r+i).attr("href",Label.servePath+"/notifications")}})},follow:function(e,t,a,n){if(!Label.isLoggedIn)return Util.needLogin(),!1;if($(e).hasClass("disabled"))return!1;var i={followingId:t};$(e).addClass("disabled"),$.ajax({url:Label.servePath+"/follow/"+a,type:"POST",cache:!1,data:JSON.stringify(i),success:function(i,o){0===i.code&&($(e).removeClass("disabled"),void 0!==n?"article"===a||"tag"===a?$(e).html('<svg class="icon-star"><use xlink:href="#star"></use></svg> '+(n+1)).attr("onclick","Util.unfollow(this, '"+t+"', '"+a+"', "+(n+1)+")").attr("aria-label",Label.uncollectLabel).addClass("ft-red"):"article-watch"===a&&$(e).html('<svg class="icon-view"><use xlink:href="#view"></use></svg> '+(n+1)).attr("onclick","Util.unfollow(this, '"+t+"', '"+a+"', "+(n+1)+")").attr("aria-label",Label.unfollowLabel).addClass("ft-red"):$(e).attr("onclick","Util.unfollow(this, '"+t+"', '"+a+"')").text("article"===a?Label.uncollectLabel:Label.unfollowLabel))},complete:function(){$(e).removeClass("disabled")}})},unfollow:function(e,t,a,n){if($(e).hasClass("disabled"))return!1;var i={followingId:t};$(e).addClass("disabled"),$.ajax({url:Label.servePath+"/unfollow/"+a,type:"POST",cache:!1,data:JSON.stringify(i),success:function(i,o){0===i.code&&(void 0!==n?"article"===a||"tag"===a?$(e).removeClass("ft-red").html('<svg class="icon-star"><use xlink:href="#star"></use></svg> '+(n-1)).attr("onclick","Util.follow(this, '"+t+"', '"+a+"',"+(n-1)+")").attr("aria-label",Label.collectLabel):"article-watch"===a&&$(e).removeClass("ft-red").html('<svg class="icon-view"><use xlink:href="#view"></use></svg> '+(n-1)).attr("onclick","Util.follow(this, '"+t+"', '"+a+"',"+(n-1)+")").attr("aria-label",Label.followLabel):$(e).attr("onclick","Util.follow(this, '"+t+"', '"+a+"')").text("article"===a?Label.collectLabel:Label.followLabel))},complete:function(){$(e).removeClass("disabled")}})},goTop:function(){$("html, body").animate({scrollTop:0},800)},goLogin:function(){if(-1===location.href.indexOf("/login")){var e=location.href;0===location.search.indexOf("?goto")&&(e=location.href.replace(location.search,"")),window.location.href=Label.servePath+"/login?goto="+encodeURIComponent(e)}},needLogin:function(){Util.goLogin()},goRegister:function(){if(-1===location.href.indexOf("/register")){var e=location.href;0===location.search.indexOf("?goto")&&(e=location.href.replace(location.search,"")),window.location.href=Label.servePath+"/register?goto="+encodeURIComponent(e)}},_kill:function(){"IE"===$.ua.browser.name&&parseInt($.ua.browser.version)<10&&$.ajax({url:Label.servePath+"/kill-browser",type:"GET",cache:!1,success:function(e,t){$("body").append(e),$("#killBrowser").dialog({modal:!0,hideFooter:!0,height:345,width:600}),$("#killBrowser").dialog("open")}})},_initActivity:function(e,t){e<=0&&(e=1);let a=0,n=setInterval((()=>{a++,a>=e&&(a=e,clearInterval(n));let t=20-e/2+"px";$("#activityProcessor .percent-wave-before").css("top",t),$("#activityProcessor .percent-wave-after").css("top",t),$("#activityProcessor .percent").html(parseInt(a)+"%")}),10)},_initBreezemoon:function(e,t,a){0!==e.length&&(t.keypress((function(t){13===t.keyCode&&e.click()})),e.click((function(){a?"disabled"!==e.attr("disabled")&&(e.attr("disabled","disabled").css("opacity","0.3"),$.ajax({url:Label.servePath+"/breezemoon",type:"POST",cache:!1,headers:{csrfToken:$(this).data("csrf")},data:JSON.stringify({breezemoonContent:t.val()}),success:function(t){if(0===t.code){let a=t.data.breezemoonAuthorName,n=t.data.breezemoonAuthorThumbnailURL48,i=t.data.breezemoonContent,o=t.data.oId,r=e.parent().parent().find(".module-list");r.prepend('<li style="display: none">\n<a href="'+Label.servePath+"/member/"+a+'">\n<span class="avatar-small slogan" aria-label="'+a+'" style="background-image: url('+n+')"></span>\n</a>\n<a href="'+Label.servePath+"/member/"+a+"/breezemoons/"+o+'" class="title">'+i+"</a>\n</li>"),e.parent().find("input").val(""),r.find("li:last").fadeOut(199,(function(){r.find("li:last").remove()})),r.find("li:first").slideDown(200),Util.listenUserCard()}else Util.alert(t.msg)},complete:function(){e.css("opacity",1).removeAttr("disabled")}})):Util.goLogin()})))},init:function(e){if($.ua.set(navigator.userAgent),"mobile"!==$.ua.device.type){let e='<div id="userCard" style="position: absolute; z-index: 130; right: auto; display: none; "></div>';$("body").append(e),Util.listenUserCard()}if(this._kill(),this._initNav(),1===$(".pagination select").length&&$(".pagination select").change((function(){var e=$(this).data("url")+"?p="+$(this).val();$(this).data("param")&&(e+="&"+$(this).data("param")),window.location.href=e})),$(".nav input.search").focus((function(){$(".nav .tags").css("visibility","hidden")})).blur((function(){$(".nav .tags").css("visibility","visible")})),$(window).scroll((function(){$(window).scrollTop()>20&&0===$(".radio-btn").length?$(".go-top").show():$(".go-top").hide()})),Util.parseMarkdown(),Util.parseHljs(),e&&(window.localStorage.hadNotificate||(window.localStorage.hadNotificate="false"),Util.setUnreadNotificationCount(!0)),$(window).keyup((function(e){27===e.keyCode&&Util.closeAlert()})),this._initBreezemoon($("#breezemoonPostBtn"),$("#breezemoonInput"),e),this._initCommonHotKey(),e)return!1;$("body").click((function(e){0===$(e.target).closest(".nav .form").length&&$(".nav .form").hide()}))},userCardCache:new Map,listenUserCard:function(){var e=!1;$(".avatar, .avatar-small, .avatar-middle, .avatar-mid, .avatar-big, .name-at").unbind(),$(".avatar, .avatar-small, .avatar-middle, .avatar-mid, .avatar-big, .name-at").hover((function(){if(void 0!==$(this).attr("aria-label")){let e,t=$(this).attr("aria-label");Util.userCardCache.has(t)?e=Util.userCardCache.get(t):$.ajax({url:Label.servePath+"/user/"+t,type:"GET",cache:!1,async:!1,headers:{csrfToken:Label.csrfToken},success:function(a){e=a,Util.userCardCache.set(t,e)}});e.followerCount,e.followingUserCount;let a=e.oId,n=(e.onlineMinute,e.userAvatarURL210),i=e.userCity,o=e.userIntro,r=e.userName,l=e.userNickname,s=e.userOnlineFlag,c=e.userPoint,d=e.userURL,u=e.userRole,f=e.cardBg,g=e.canFollow,h=e.userNo,p=e.userAppRole,b=JSON.parse(e.sysMetal),v=e.mbti,m='<div class="user-card" id="userCardContent">\n    <div>\n        <a href="'+Label.servePath+"/member/"+r+'">\n            <div class="avatar-mid-card" style="background-image: url('+n+');"></div>\n        </a>\n        <div class="user-card__meta">\n            <div class="fn__ellipsis">\n                <a class="user-card__name" href="'+Label.servePath+"/member/"+r+'"><b>'+l+'</b></a>\n                <a class="ft-gray ft-smaller" href="'+Label.servePath+"/member/"+r+'"><b>'+r+"</b></a>\n";if(""!==v){let e=v;v.indexOf("-")>0&&(e=v.split("-")[0]),m+='<a target="_blank" href="https://www.16personalities.com/ch/'+e+'-%E4%BA%BA%E6%A0%BC" class="tooltipped-new tooltipped__n" rel="nofollow"\n   aria-label="TA是 '+v+'">\n   <span style="background-color: #b2b1ff;color: #fff;font-size: 12px;line-height: 20px;border-radius: 3px;height: 20px;display: inline-block;padding: 0 5px;vertical-align: middle;box-sizing: border-box;svg {margin-top: 2px;}">   <svg style="vertical-align: -3px"><use xlink:href="#mbti"></use></svg> '+v+"</span></a>\n"}m+="            </div>\n",""!==o?m+='            <div class="user-card__info vditor-reset">\n                '+o+"\n            </div>\n":"0"===p?m+='<div class="user-card__info vditor-reset">摸鱼派 '+h+" 号成员，<b>黑客</b></div>\n":"1"===p&&(m+='<div class="user-card__info vditor-reset">摸鱼派 '+h+" 号成员，<b>画家</b></div>\n");let w=b.list;if(void 0!==w&&0!==w.length){m+='<div class="user-card__info vditor-reset">';for(let e=0;e<w.length;e++){let t=w[e];m+="<img title='"+t.description+"' src='"+Util.genMetal(t.name,t.attr)+"'/>"}m+="</div>"}switch(m+='            <div class="user-card__icons fn__flex">\n                <div class="fn__flex-1">\n                    <a href="https://fishpi.cn/article/1630575841478" class="tooltipped__n tooltipped-new"\n                       aria-label="用户分组：'+u+'">\n',u){case"管理员":m+='<img style="height: 20px;margin: 0px;" src="https://file.fishpi.cn/adminRole.png"/>';break;case"OP":m+='<img style="height: 20px;margin: 0px;" src="https://file.fishpi.cn/opRole.png"/>';break;case"纪律委员":m+='<img style="height: 20px;margin: 0px;" src="https://file.fishpi.cn/policeRole.png"/>';break;case"超级会员":m+='<img style="height: 20px;margin: 0px;" src="https://file.fishpi.cn/svipRole.png"/>';break;case"成员":m+='<img style="height: 20px;margin: 0px;" src="https://file.fishpi.cn/vipRole.png"/>';break;default:m+='<img style="height: 20px;margin: 0px;" src="https://file.fishpi.cn/newRole.png"/>'}m+="                    </a>\n",m+='                    <a href="'+Label.servePath+"/member/"+r+'/points" class="tooltipped-new tooltipped__n"\n                       aria-label="'+c+' 积分">\n                        <svg>\n                            <use xlink:href="#iconPoints"></use>\n                        </svg>\n                    </a>\n',""!==i&&(m+='<a href="'+Label.servePath+"/city/"+i+'" class="tooltipped-new tooltipped__n" rel="nofollow"\n   aria-label="'+i+'">\n    <svg>\n        <use xlink:href="#icon-local"></use>\n    </svg>\n</a>\n'),""!==d&&(m+='<a target="_blank" href="'+Label.servePath+"/forward?goto="+d+'" class="tooltipped-new tooltipped__n" rel="nofollow"\n   aria-label="'+d+'">\n    <svg>\n        <use xlink:href="#card-link"></use>\n    </svg>\n</a>\n'),m+='<a class="tooltipped-new tooltipped__n" rel="nofollow" onclick="javascript:void(0)" style="background-color:#eeeeeecc;border-radius:5px;padding:0 7px 0 4px;cursor:default;color:#6d6c6c;font-size:12px;"\n   aria-label="'+h+' 号成员">\n    <svg style="height: 12px; vertical-align: -4.5px">\n        <use xlink:href="#no"></use>\n    </svg>    <span style="margin: 0;float: none;vertical-align: -3px;">'+h+"</span> \n</a>\n",m+="                </div>\n",m+=!0===s?'<span style="background-color:#d23f31;color:#fff;font-size:12px;line-height:20px;border-radius:3px;height:20px;display:inline-block;padding:0 5px;vertical-align:middle;box-sizing:border-box;">在线</span>':'<span style="background-color:rgba(0,0,0,0.54);color:#fff;font-size:12px;line-height:20px;border-radius:3px;height:20px;display:inline-block;padding:0 5px;vertical-align:middle;box-sizing:border-box;">离线</span>',m+='                <div class="fn__shrink">\n                    <a class="green small btn" href="'+Label.servePath+"/chat?toUser="+r+'" rel="nofollow">\n                        私信\n                    </a>\n',"yes"===g?m+='<button class="follow small" onclick="Util.follow(this, \''+a+"', 'user')\">\n 关注\n</button>":"no"===g&&(m+='<button class="follow small" onclick="Util.unfollow(this, \''+a+"', 'user')\">\n 取消关注\n</button>"),m+="                </div>\n            </div>\n        </div>\n    </div>\n</div>",$("#userCard").html(m),""!==f&&($("#userCardContent").addClass("user-card--bg"),$("#userCardContent").css("background-image","url("+f+")"),$("#userCardContent > div").attr("style","background-image: linear-gradient(90deg, rgba(214, 227, 235, 0.36), rgba(255, 255, 255, 0.76), rgba(255, 255, 255, 0.76));"),$("#userCardContent > div > a > div").css("width","105px"),$("#userCardContent > div > a > div").css("height","105px"),$("#userCardContent > div > a > div").css("top","80px"));let y=$(this).offset().left;y+=30,y+350>$(document.body).width()&&(y-=350),$("#userCard").css("left",y);let x=$(this).offset().top-110;x<45&&(x=$(this).offset().top+45),$("#userCard").css("top",x+"px"),$("#userCard").show()}}),(function(t){setTimeout((function(){let a=$(t.toElement);0===$(a).parents("#userCard").length&&(e||$("#userCard").hide())}),50)})),$("#userCard").unbind(),$("#userCard").hover((function(){e=!0}),(function(){e=!1,$("#userCard").hide()}))},initUserChannel:function(e){var t=new WebSocket(e);t.onopen=function(){console.log("Connected to user channel websocket.")},t.onmessage=function(e){var t=JSON.parse(e.data);switch(t.command){case"bz-update":if(void 0!==$(".active-bz-list-big")[0]){let e=t.bz.breezemoonAuthorName,a=t.bz.breezemoonAuthorThumbnailURL48,n=t.bz.breezemoonContent,i=t.bz.oId;$($(".active-bz-list-big")[0]).prepend('<li><div class="fn-flex"><div class="fn-flex-1"><div class="fn-flex"><a rel="nofollow" href="'+Label.servePath+"/member/"+e+'"><div class="avatar" aria-label="'+e+'" style="background-image:url(\''+a+'\')"></div></a><div class="fn-ellipsis ft-fade ft-smaller list-info"><a rel="nofollow" class="author" href="'+Label.servePath+"/member/"+e+'">'+e+'</a><br>刚刚<br></div></div><a style="color: #3b3b3b" class="abstract" href="'+Label.servePath+"/member/"+e+"/breezemoons/"+i+'">'+n+"</a></div></div></li>")}if(void 0!==$(".active-bz-list")[0]){let e=t.bz.breezemoonAuthorName;if(e!=Label.currentUserName){let a=t.bz.breezemoonAuthorThumbnailURL48,n=t.bz.breezemoonContent,i=t.bz.oId,o=$($(".active-bz-list")[0]);o.prepend('<li style="display: none">\n<a href="'+Label.servePath+"/member/"+e+'">\n<span class="avatar-small slogan" aria-label="'+e+'" style="background-image: url('+a+')"></span>\n</a>\n<a href="'+Label.servePath+"/member/"+e+"/breezemoons/"+i+'" class="title">'+n+"</a>\n</li>"),o.find("li:last").fadeOut(199,(function(){o.find("li:last").remove()})),o.find("li:first").slideDown(200),Util.listenUserCard()}}break;case"refreshNotification":"/cr"===window.location.pathname?(Util.makeNotificationRead("at"),Util.setUnreadNotificationCount(!0)):(Util.setUnreadNotificationCount(!0),0!==t.count&&Util.notice("default",3e3,"你有新的通知！<a href='/notifications'>点击查看</a>"));break;case"chatUnreadCountRefresh":0===t.count&&Util.pauseBling(),$("#aChatCount").text(t.count);break;case"newIdleChatMessage":if($("#aChatCount").text(parseInt($("#aChatCount").text())+1),"/chat"!==window.location.pathname)Util.blingChat(),Util.notice("warning",3e3,"叮咚！"+t.senderUserName+" 向你发送了一条私信。<a href='/chat?toUser="+t.senderUserName+"'>点击查看</a>");else{let e=t.preview.substring(0,10),a=t.preview.length>10?"...":"",n=t.senderUserName,i=t.senderAvatar;$("#chatTo"+n).length<=0?Chat.addToMessageList(n,i,e):$("#chatTo"+n).find("span").html(e+a),"rgb(241, 241, 241)"!==$("#chatTo"+n).css("background-color")&&$("#chatTo"+n).css("background-color","#fff4eb");let o=$("#chatTo"+n).prop("outerHTML");$("#chatTo"+n).remove(),$("#chatMessageList").prepend(o)}break;case"warnBroadcast":let e=t.warnBroadcastText,a=t.who;Util.alert('<style>.dialog-header-bg {border-radius: 4px 4px 0px 0px; background-color: rgb(151,49,210); color: rgb(255, 255, 255);}.dialog-main {height: 170px;overflow: auto;}</style><div class="fn-hr5"></div>\n<div class="ft__center">\n<div><h1>摸鱼派社区紧急公告</h1><br>'+e+"<br><br>——紧急公告发布人："+a+"</div></div>\n","紧急公告"),Util.alert(e),$(".dialog-background").attr("onclick","")}},t.onclose=function(){console.log("Disconnected to user channel websocket.")},t.onerror=function(e){console.log("ERROR",e)}},blingChat:function(){$("#aChat").removeClass("no-msg").addClass("msg"),Util.isBlinging||(Util.isBlinging=!0,bling=setInterval((function(){$("#aChat").removeClass("no-msg").addClass("msg"),setTimeout((function(){$("#aChat").removeClass("msg").addClass("no-msg")}),1e3)}),2e3))},pauseBling:function(){$("#aChat").removeClass("msg").addClass("no-msg"),Util.isBlinging&&(Util.isBlinging=!1,clearInterval(bling))},_initNav:function(){var e=location.href;$(".user-nav > a").each((function(){0===e.indexOf($(this).attr("href"))?$(this).addClass("current"):"/register"===location.pathname?$(".user-nav a:last").addClass("current"):"/login"===location.pathname?$(".user-nav a:first").addClass("current"):0!==e.indexOf(Label.servePath+"/settings")&&0!==e.indexOf($("#aPersonListPanel").data("url"))||$("#aPersonListPanel").addClass("current")})),$(".nav .avatar-small").parent().click((function(){$("#personListPanel").show()})),$("body").click((function(e){"aPersonListPanel"!==$(e.target).closest("a").attr("id")&&"personListPanel"!==$(e.target).closest(".module").attr("id")&&$("#personListPanel").hide()}))},logout:function(){window.localStorage&&(window.localStorage.clear(),window.localStorage.hadNotificate="false"),window.location.href=Label.servePath+"/logout?goto="+Label.servePath},startsWith:function(e,t){return e.match("^"+t)==t},mouseClickEffects:function(){var e=0;jQuery(document).ready((function(t){t("html").click((function(a){var n,i=18;10==++e?n=t("<b></b>").text("OωO"):20===e?n=t("<b></b>").text("(๑•́ ∀ •̀๑)"):30===e?n=t("<b></b>").text("(๑•́ ₃ •̀๑)"):40===e?n=t("<b></b>").text("(๑•̀_•́๑)"):50===e?n=t("<b></b>").text("（￣へ￣）"):60===e?n=t("<b></b>").text("(╯°口°)╯(┴—┴"):70===e?n=t("<b></b>").text("૮( ᵒ̌皿ᵒ̌ )ა"):80===e?n=t("<b></b>").text("╮(｡>口<｡)╭"):90===e?n=t("<b></b>").text("( ง ᵒ̌皿ᵒ̌)ง⁼³₌₃"):e>=100&&e<=105?n=t("<b></b>").text("(ꐦ°᷄д°᷅)"):(n=t('<svg><use xlink:href="#heart"></use></svg>'),i=Math.round(14*Math.random()+6));var o=a.pageX,r=a.pageY;n.css({"z-index":9999,top:r-20,left:o,position:"absolute",color:"#E94F06","font-size":i,"-moz-user-select":"none","-webkit-user-select":"none","-ms-user-select":"none"}),t("body").append(n),n.animate({top:r-180,opacity:0},1500,(function(){n.remove()}))}))}))},notice:function(e,t,a,n){void 0!==n?$.tooltips(a,{type:e,duration:t,callback:n}):$.tooltips(a,{type:e,duration:t})}},Validate={goValidate:function(e){for(var t="<ul>",a=0;a<e.data.length;a++)Validate.validate(e.data[a])||(t+="<li>"+e.data[a].msg+"</li>");return"<ul>"===t?(e.target.html(""),e.target.removeClass("error"),!0):(e.target.html(t+"</ul>"),e.target.addClass("error"),!1)},validate:function(e){var t=!0,a="";switch(a="editor"===e.type?e.target.getValue():"imgSrc"===e.type?e.target.attr("src"):"imgStyle"===e.type?e.target.data("imageurl"):e.target.val().toString().replace(/(^\s*)|(\s*$)/g,""),e.type){case"email":/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(e.target.val())||(t=!1);break;case"password":(e.target.val().length<6||e.target.val().length>16||!/\d/.test(e.target.val())||!/[A-Za-z]/.test(e.target.val()))&&(t=!1);break;case"confirmPassword":e.target.val()!==e.original.val()&&(t=!1);break;case"tags":var n=a.split(",");(""===a||n.length>7)&&(t=!1);for(var i=0;i<n.length;i++)if(""===n[i].replace(/(^\s*)|(\s*$)/g,"")||n[i].replace(/(^\s*)|(\s*$)/g,"").length>50){t=!1;break}break;case"url":case"imgSrc":case"imgStyle":(""===a||""!==a&&(!/^\w+:\/\//.test(a)||a.length>100))&&(t=!1);break;case"phone":/^[1][0-9]{10}$/.test(e.target.val())||(t=!1);break;default:t=a.length<=e.max&&a.length>=(e.min?e.min:0)}return t}},Label={},pngMagic=[137,80,78,71,13,10,26,10],jpeg_jfif=[74,70,73,70],jpeg_exif=[69,120,105,102],jpegMagic=[255,216,255,224],gifMagic0=[71,73,70,56,55,97],getGifMagic1=[71,73,70,56,57,97],wavMagic1=[82,73,70,70],wavMagic2=[87,65,86,69];function arraycopy(e,t,a,n,o){for(i=0;i<o;i++)a[n+i]=e[t+i]}function arrayEquals(e,t){if("undefined"==e||"undefined"==t)return!1;if(e instanceof Array&&t instanceof Array){if(e.length!=t.length)return!1;for(i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}return!1}function isImage(e){return null!==getImageMime(e)}function getImageMime(e){if(null==e||"undefined"==e||e.length<8)return null;var t=[];return arraycopy(e,0,t,0,6),isGif(t)?"image/gif":(arraycopy(e,6,t=[],0,4),isJpeg(t)?"image/jpeg":(arraycopy(e,0,t=[],0,8),isPng(t)?"image/png":null))}function isAudio(e){if(null==e||"undefined"==e||e.length<12)return null;var t=[];arraycopy(e,0,t,0,4);var a=[];return arraycopy(e,8,a,0,4),isWav(t,a)?"audio/wav":null}function isGif(e){return arrayEquals(e,gifMagic0)||arrayEquals(e,getGifMagic1)}function isJpeg(e){return arrayEquals(e,jpegMagic)||arrayEquals(e,jpeg_jfif)||arrayEquals(e,jpeg_exif)}function isPng(e){return arrayEquals(e,pngMagic)}function isWav(e,t){return arrayEquals(e,wavMagic1)&&arrayEquals(t,wavMagic2)}function getUUID(){var e=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var a=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?a:3&a|8).toString(16)}));return t=t.replace(new RegExp("-","g"),"")}var Audio={availabel:!1,wavFileBlob:null,recorderObj:null,init:function(e){var t=new BrowserGetUserMediaDetection;t.getUserMediaSupported()?(navigator.getUserMedia=t.getUserMediaMethod(),navigator.getUserMedia({audio:!0},(function(t){var a=2048,n=PredefinedRecordingModes.MONO_5_KHZ,i=n.getSampleRate(),o=n.getChannelCount(),r=new BrowserWindowAudioContextDetection;if(!r.windowAudioContextSupported()){var l="Unable to detect window audio context, cannot continue.";return void console.log("getUserMedia->success(): "+l)}var s=r.getWindowAudioContextMethod();Audio.recorderObj=new SoundRecorder(s,a,i,o),Audio.recorderObj.init(t),Audio.recorderObj.recorder.onaudioprocess=function(e){if(Audio.recorderObj.isRecording()){var t=e.inputBuffer.getChannelData(0),a=e.inputBuffer.getChannelData(1);Audio.recorderObj.cloneChannelData(t,a)}},Audio.availabel=!0,e&&e()}),(function(e){console.log("getUserMedia->failure(): ERROR: Microphone access request failed!");var t="PermissionDeniedError",a="DevicesNotFoundError";switch(e.name){case t:Label.recordDeniedLabel;break;case a:Label.recordDeviceNotFoundLabel;break;default:"ERROR: The following unexpected error occurred while attempting to connect to your microphone: "+e.name}}))):console.log("ERROR: getUserMedia not supported by browser.")},handleStartRecording:function(){Audio.recorderObj.startRecordingNewWavFile()},handleStopRecording:function(){Audio.recorderObj.stopRecording(),Audio.wavFileBlob=Audio.recorderObj.buildWavFileBlob()}};function Rotate(e){let t=!1,a=!1;this.submit=function(){if(!a){a=!0;let n,i,o=0;void 0===i&&(n=document.getElementById(e).getAttribute("style"),null!=n&&""!==n?n.endsWith(";")||(n+=";"):n="",i=setInterval((function(){o+=5,o>360&&(o=0),document.getElementById(e).setAttribute("style",n+"-webkit-transform: rotate("+o+"deg);"),0===o&&t&&(clearInterval(i),document.getElementById(e).setAttribute("style",n),a=!1)}),15))}},this.stop=function(){t=!0},String.prototype.endWith=function(e){const t=this.length-e.length;return t>=0&&this.lastIndexOf(e)===t}}